<!DOCTYPE html>
<html data-wf-domain="" data-wf-page="56d6955f710a7126338b8b19" data-wf-site="56d6955f710a7126338b8b1c">
  <head>
    <meta charset="utf-8">
    <title>A Deep Dive: PBFT and The Hyperledger Blockchain | Blog</title>
    <meta content="Hyperledger" name="description">
    <meta content="Consensus Mechanism" property="og:title">
    <meta content="" property="og:description">
    <meta property="og:image" content="">
    <meta content="summary" name="twitter:card">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <meta content="Webflow" name="generator"><link href="/blog/style.css" rel="stylesheet" type="text/css">
    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.4.7/webfont.js"></script>
    <script type="text/javascript">WebFont.load({
        google: {
        families: ["Open Sans:300,300italic,400,400italic,600,600italic,700,700italic,800,800italic","Lato:100,100italic,300,300italic,400,400italic,700,700italic,900,900italic","Fjalla One:regular"]
        }
      });
    </script>
    <script src="https://daks2k3a4ib2z.cloudfront.net/0globals/modernizr-2.7.1.js" type="text/javascript"></script>
    <link href="/images/fav-icon.png" rel="shortcut icon" type="image/x-icon">
    <link href="https://daks2k3a4ib2z.cloudfront.net/img/webclip.png" rel="apple-touch-icon">
  </head>

  <body>
    <div class="sidebar-column">
      <div class="navigation-bar w-nav" data-animation="default" data-collapse="medium" data-contain="1" data-duration="400">
        <div class="w-container"><a class="logo-link w-nav-brand" href="/"><h1 class="logo-text">RealChain ï ‚Ä¢·¥•‚Ä¢ î</h1></a>
          <nav class="navigation-menu w-nav-menu" role="navigation">
              <p class="main-subheading w-hidden-medium w-hidden-small w-hidden-tiny">
                  Hi there, I‚Äôm Sonia aka realchain ï ‚Ä¢·¥•‚Ä¢ î. I am an independent <b>Bot & Protocol Developer</b>, <b>writer</b> 
                  and <b>speaker</b> from the Africa. I <a href="/blog/archive/">write</a>, <a href="https://twitter.com/realchainlife">tweet</a>, 
                  <a href="/blog/speaking/">speak</a> and <a href="http://github.com/realchainlife">share code</a> about building 
                  decentralized systems. We can <a href="/contact/">work together</a>
              </p>
              <h4>Projects</h4>
              <ul class="[ list-ui  list-ui--small ]  mb">
                <li><a href="http://playmakerchain.com">PlayMaker Chain ‚öΩÔ∏è</a> ‚Äì coming soon‚Ä¶</li>
                <li><a href="http://factory24.org">Afrolynk Factory24 üìà</a> ‚Äì here now ‚Ä¶</li>
                <li><a href="http://realchainlife.github.io/portfolio/workshops.html">Nairobi IPFS</a> ‚Äì Here Now! </li>
              </ul>
              <h4>Upcoming Events</h4>
              <ul class="[ list-ui  list-ui--small ]  mb">
                <li><a href="https://africanwomenintech.com/">AWIT Conference</a> ‚Äì Nairobi, (Kenya) July 2019</li>
                <li><a href="http://afrolynk.com">Afrolynk Conference</a> ‚Äì Berlin, (Germany) September 2019</li>
              </ul>
              <div class="divider"></div>
              <div class="social-link-group">
                <a class="social-icon-link w-inline-block" href="https://twitter.com/realchainlife"><img src="http://uploads.webflow.com/56d6955f710a7126338b8b1c/56d6955f710a7126338b8b95_social-18-white.svg" width="25"></a>
                <a class="social-icon-link w-inline-block" href="https://github.com/realchainlife"><img src="http://uploads.webflow.com/56d6955f710a7126338b8b1c/56d6955f710a7126338b8b9f_social-33-white.svg" width="25"></a>
              </div>
            </nav>
          <div class="menu-button w-nav-button"><div class="w-icon-nav-menu"></div>
        </div>
      </div>
    </div>
  </div>
  <div class="content">
    <div class="w-container">
      <div class="post-title-section">
        <h1>A Deep Dive: PBFT and The Hyperledger Blockchain</h1>
        <div class="post-info-wrapper">
          <div class="post-info">February 11, 2018</div>
          <div class="post-info">|</div>
          <a class="post-info when-link" href="/categories/cryptography">Cryptography</a>
        </div>
      </div>
      <div class="body-copy w-richtext">
        <p>Blockchain networks are designed as peer-to-peer systems that don‚Äôt have 
            centralized authority points to function but for the decentralized infrastructure
            to exist and work, they need an in-built decision-making feature commonly 
            known as <i>consensus</i>. When implemented, consensus algorithms allow every 
            member of the network to partcipate in the blockchain development by making 
            decisions on the network's future.
        </p>
        <p>In my previous post, <a href="https://realchainlife.github.io/blog/posts/demystifying-consensus-algorithms.html">Demystifying Consensus Algorithms</a>, 
            we delved into the various consensus algorithms discussing some base functionalities 
            and mechanisms of these consensus algorithms. We highlighted certain benefits of the 
            Practical Byzantine Fault Tolerance (PBFT) Algorithm and why it was the algorithm of 
            choice for the Hyperledger Blockchain.
        </p>
        <p>In this post we will answer the question, what is practical Byzantine 
            Fault Tolerance as a complete beginner's guide. We'll cover it orgins, 
            how it differs from other algorithms and why its used on the Hyperledger
            and other Blockchain solutions.
        </p>
        <h2>Evolution of Byzantine Fault Tolerance</h2>
        <p>Practical Byzantine Fault Tolerance is a consensus algorithm introduced 
            in the late 90s as a solution to a problem presented by the previous use 
            of BGP (<i>Byzantine Generals Problem</i>). pBFT was designed after extensive
            research and has been optimized with a diverse set of solutions in practise
            to work efficiently in asynchronous systems.
        </p>
        <p>In the context of distributed systems, BFT is the ability of a blockchain 
            network to function as desired and correctly reach a sufficient consensus 
            despite malicious components (nodes) of the network failing or propagating 
            incorrect information to other peers. The objective is to defend against 
            catastrophic system failures by mitigating the influence these malicious 
            nodes have on the correct function of the network and the right consensus 
            that is reached by the honest nodes in the system.
        </p>
        <h2>Practical Byzantine Fault Tolerant Mechanism</h2>
        <p>PBTF is a robust, high-performance algorithm that comes with only a 3% 
            increase in latency over a standard unreplicated BFT models.
        </p>
        <p>Unlike PoW or PoS mechanisms, pBFT doesn‚Äôt require any hashing power to add 
            new blocks to the underlying blockchain. This makes the algorithm much more 
            energy efficient and eventually allows it to avoid issues with centralization 
            that PoW (mining pools) and PoS (large stake holders cutting deals behind the 
            scenes) suffer from.
        </p>
        <p>Nodes in a pBFT blockchain system are sequentially ordered with one node being 
            the <strong>primary node</strong> and others considered as <strong>secondary nodes</strong>. 
            All of the nodes within the system communicate with each other and the goal is for 
            all of the honest nodes to come to an agreement of the state of the system through 
            a majority. Any node in the system can assume the role of primary if an old primary 
            node fails or starts acting maliciously. The primary node is changed during every 
            consensus round nonetheless.
        </p>
        <figure data-rt-type="image" data-rt-align="center" data-rt-max-width="60" class="w-richtext-align-center" 
          style="max-width: 60%;" data-rt-max-height="33.75">
          <div><img src="/blog/blog-img/practical-byzantine-fault-tolerance.png" alt=""></div>
          <figcaption>Illustration: pBFT</figcaption>
        </figure>
        <p>The pBFT model works on the assumption that, at any point in time, the total 
            amount of malicious nodes on the network doesn't exceed more than 1/3 of the 
            total number of network nodes in the system in a given window of vulnerability. 
            The more nodes a pBFT system has, the safer it becomes.
        </p>
        <p>Block generation and confirmation in this consensus group follows more of a 
            <i>‚ÄúCommander and Lieutenant‚Äù</i> format. When a client sends a request to the primary
            node the request is processed in three phases:
        </p>
        <ul>
          <li><strong>Pre-prepare phase</strong>: Here, the primary node announces the request
              to the secondary nodes as a multicast pre-prepare message. The secondary
              nodes receive a <i>new block</i> suggestion that the group should agree on.</li>
          <li><strong>Prepare phase</strong>: Once received, every node executes the request by 
              <i>validating</i> the correctness and authencity of the detailed record. Another
              multicast reply is then sent to the client.</li>
          <li><strong>Commit phase</strong>: In this phase, the client prepares to receive a message
              from the <i>f + 1</i> majority nodes to ensure that a sufficient number of nodes 
              have agreed on the new block proposed by the primary node.</li>
        </ul>
        <p>One PBFT algorithm needs to have a minimum of <i>3f + 1</i> replicas (where f is the 
            maximum number of faulty nodes) to ensure that its Byzantine Fault tolerance 
            is unharmed. This is the mathematical representation of 2/3rd majority.
        </p>
        <h2>PBFT Implementation on Hyperledger</h2>
        <p>"Hyperledger" is an open-source collaborative consortium for blockchain projects 
            hosted by the Linux Foundation using a permissioned version of pBFT for the platform. 
            Currently there are at least 4 different implementations of blockchain frameworks 
            under Hyperledger:
        </p>
        <ul>
          <li>Fabric (IBM)</li>
          <li>Corda (R3)</li>
          <li>Iroha</li>
          <li>Sawtooth Lake (Intel)</li>
        </ul>
        <p><strong>In Fabric</strong></p>
        <p>All validation peers keep open connection to each other. You can submit your transaction 
            to any of them, and this transaction will be broadcasted to other peers in the network. 
            One of peer is elected as "leader". At the moment when a new block is going to be generated:
        </p>
        <ol>
          <li>The leader orders the transactions candidates that should be included in a block, 
              and broadcasts this list of ordered transactions to all other validation peers in 
              the network.</li>
          <li>When each of the Validation Peers receives the ordered list of transactions, each 
              validation peer does the following:
          
              <quote>It starts executing the ordered transactions one by one. As soon as all the 
                  transactions are executed, it will calculate the hash code for the newly 
                  created bloc (the hash code includes hashes for executed transactions and 
                  final state of the world). Then it broadcasts the resulting hash code to other 
                  peers in the network, and starts counting the responses from them.</quote>
          </li>
        </ol>
        <p>If it sees that 2/3 of all validation peers have the same hash code, it will commit 
            the new block to its local copy of the ledger.
        </p>
        <p><strong>In Corda</strong></p>
        <p>PBFT is not used. This implementation uses another architecture approach. In Corda, 
            consensus is provided by notaries. It is up to the notary operator which consensus 
            algorithm they use. BFT is one option. You can see a Corda BFT notary sample 
            <a href="https://github.com/corda/corda/tree/master/samples/notary-demo">here</a>.
        </p>
        <ol>
          <li>The transaction is validated by a cluster of one or more notaries. Notaries 
              are nodes with the sole purpose of deconflicting double-spend attempts.</li>
          <li>Using a standard BFT algorithm. Each node in the notary cluster votes on 
              whether they consider the transaction to be a double-spend attempt. The final 
              decision is based on a majority rule, and can tolerate up to 1/3rd of the 
              nodes in the cluster being malicious.</li>
          <li>In Corda, there is no central store of information that the transaction is 
              committed to. The notary cluster simply adds the spent state reference to an 
              internal database table. It will check future attempts to spend states against 
              this table, and reject the spending attempt if the state reference is already 
              stored there.</li>
        </ol>
        <p><strong>In Hyperledger Sawtooth</strong></p>
        <ul>
          <li><strong>PoET</strong> Proof of Elapsed Time (optional Nakamoto-style consensus algorithm used for 
              Sawtooth). PoET with SGX has BFT. PoET Simulator has CFT. Not CPU-intensive as 
              with PoW-style algorithms, although it still can fork and have stale blocks . 
              See <a href="https://sawtooth.hyperledger.org/docs/core/releases/latest/architecture/poet.html">PoET specification</a>
          </li>
          <li><strong>RAFT Consensus</strong> algorithm that elects a leader for a term of arbitrary time. Leader 
              replaced if it times-out. Raft is faster than PoET, but is not BFT (Raft is CFT). 
              Also Raft does not fork. Hyperledger Sawtooth has the advantage of having Unpluggable 
              Consensus. An algorithm can be changed without reinitializing the blockchain or even 
              restarting the software.
          </li>
        </ul>
        <p>Since permissioned chains use small consensus groups and don‚Äôt need the same decentralization 
            as public blockchains, pBFT is effective for providing high-throughput transactions.
        </p>
        <h2>Limitations of PBFT</h2>
        <p>The pBFT consensus model works efficiently only when the number of nodes in the distributed 
            network is small due to the high communication overhead that increases exponentially with every 
            extra node in the network.
        </p>
        <ul>
          <li><strong>Sybil attacks</strong> : The pBFT mechanisms are susceptible to Sybil attacks, where a
              single entity controls multiple network nodes - compromising network security. This 
              threat is reduced with larger network sizes but considering the scalability issue of 
              pBFT it typically needs to be used in combination with another consensus mechanism.
          </li>
          <li><strong>Scaling</strong> : pBFT does not scale well because of its communication intensive overhead. 
              This is because each node must talk to every other node to keep the network secure, which 
              can quickly grow into a huge communication cost as the amount of nodes scales upwards. 
              When the number of nodes in the network increase so does the time taken to respond to the 
              request. pBFT is a promising consensus solution when the group of nodes is small but becomes 
              inefficient for large networks.
          </li>
        </ul>
        <h2>Summary</h2>
        <p>Permissioned blockchains are private and operated by invite with known identities, meaning there is 
            already an element of trust between parties. This mitigates the need for a trustless environment and 
            allows the network to reap the benefits of pBFT without the downsides.
        </p>
      </div>
      <div class="button-wrapper"><a class="button w-button" href="/blog/archive">‚Üê&nbsp;View all posts</a></div>
    </div>
  </div>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js" type="text/javascript"></script>
  <script src="https://daks2k3a4ib2z.cloudfront.net/56d6955f710a7126338b8b1c/js/webflow.3283bff92.js" type="text/javascript"></script>
<!--[if lte IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif]-->
</body>
</html>

